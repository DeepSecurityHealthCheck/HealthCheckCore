---
#This yaml has the object to define the values related to the ANTI MALWARE
#configuration specified per computer
#expected accordingly the deep security best practice guide (v11.0).
#Version 0.1 04-01-2019

#The title is used for python scripts to call the information related to the
#module. Please, do not change it.
title: "anti_malware"
descrption: ""
anti_malware:
  #It checks if antimalware module is activated.
  anti_malware.state:
    weight: 10
    #It has six possible operators. For this comparison, it is equal.
    operator: EQUAL
    operand: "on"
    #It is the information that will be shown in the report. The values below
    #create the report information.
    description:
      module: "anti_malware"
      failure_item: "Anti Malware State is off"
      text: "It's important to activate this module to prevent malware infection."
  #Real-Time Scan uses multi-threaded scans by default. However, for on-demand
  #and scheduled scans, this option needs to be configured, depending on the environment.
  policy_settings.anti_malware_setting_malware_scan_multithreaded_processing_enabled.value:
    #Weight can be changed accordingly with the knowledge of the analyst
    #about the customer environment, giving to it a right metric.
    #It is the possible weight that the configuration has in the final grade of the environment.
    weight: 5
    #It has six possible operators. For this comparison, it is equal.
    operator: EQUAL
    #It is the recommended value for this topic in the DS-BPG.
    operand: "true"
    #It is the information that will be shown in the report. The values below
    #create the report information.
    description:
      module: "anti_malware"
      failure_item: "Malware scan multithreaded processing"
      text: >
        "Enabling multithreaded processing can improve performance.
        Real-Time Scan uses multi-threaded scans by default.
        However, for on-demand and scheduled scans, this option needs to be configured,
        depending on the environment. "
  #Maximum disk space used to store quarantined files: This represents the maximum space that the Deep
  #Security Manager sets aside for Deep Security Virtual Appliance. Files from all protected virtual machines
  #(VMs) must share this space.
  policy_settings.anti_malware_setting_identified_files_space_max_mbytes.value:
    weight: 4
    operator: NOT_EQUAL
    operand: "1024" #Change it. Custom, String.
    description:
      module: "anti_malware"
      failure_item: "(DSVA) Max space to store identified files should be a custom value"
      text: >
        "This represents the maximum space that the Deep Security Manager sets
        aside for Deep Security Virtual Appliance. "
  #Maximum file size to scan: This is the largest file that can be quarantined.
  policy_settings.anti_malware_setting_scan_file_size_max_mbytes.value:
    weight: 4
    operator: NOT_EQUAL
    operand: '0' #Change it. Custom, String.
    description:
      module: "anti_malware"
      failure_item: "(DSVA) Change 'Maximum file size to scan' to a custom value"
      text: "This is the largest file that can be quarantined. "
  #Enable the scan cache and change the cache time based on your real situation.
  policy_settings.anti_malware_setting_scan_cache_on_demand_config_id.value:
    weight: 6
    operator: NOT_EQUAL
    operand: "" #Change it. Custom, String.
    description:
      module: "anti_malware"
      failure_item: "Scan cache on demand should be on"
      text: >
        "(Used by DSVA) maximize the efficiency of malware scans of virtual machines. Enable it and change the cache time based on your needs . "
  #Enable the scan cache and change the cache time based on your real situation.
  policy_settings.anti_malware_setting_scan_cache_real_time_config_id.value:
    weight: 7
    operator: NOT_EQUAL
    operand: "" #Change it. Custom, String.
    description:
      module: "anti_malware"
      failure_item: "(DSVA) Enable Real-Time Scan Cache to improve performance"
      text: >
        "(Used by DSVA) maximize the efficiency of malware scans of virtual machines. Enable it and change the cache time based on your needs. "



    #CONNECTED THREAT DEFENSE ==================================================
  #Enable submission of suspicious files to Deep Discovery Analyzer
  policy_settings.anti_malware_setting_connected_threat_defense_suspicious_file_ddan_submission_enabled.value:
    #Weight can be changed accordingly with the knowledge of the analyst  
    #about the customer environment, giving to it a right metric.
    #It is the possible weight that the configuration has in the final grade of the environment.
    weight: 8
    #It has six possible operators. For this comparison, it is equal.
    operator: EQUAL
    #It is the recommended value for this topic in the DS-BPG.
    operand: "true"
    #It is the information that will be shown in the report. The values below
    #create the report information.
    description:
      module: "anti_malware"
      failure_item: "(CTD) Enable submission of suspicious files to DDAN"
      text: >
        "Enable submission of suspicious files to Deep Discovery Analyzer.
        "
  #Compare objects against Suspicious Object List
  policy_settings.anti_malware_setting_connected_threat_defense_use_control_manager_suspicious_object_list_enabled.value:
    weight: 4
    operator: EQUAL
    operand: "true"
    description:
      module: "anti_malware"
      failure_item: "(CTD) Enable compare objects against suspicious object list"
      text: "Compare objects against Suspicious Object List. "

...
